/*
* author: Lin Xiao Dong <1071322670@qq.com>
* update: 2019.03.29
* website: http://www.openwbs.com/
*/
function client(){this.typeInit=function(a){var c,d,b=a.section,e=OW.typeid.split("-");for(c=0;c<e.length;c++)d=OW.int(e[c]),b.find("[name='ctype'][type_id='"+d+"']").addClass("current");0==b.find("[name='ctype']").length&&b.hide()},this.uploadInput="",this.uploadDialog="",this.upload=function(a){OW.client.uploadInput=$("input[name='"+a.inputName+"']"),OW.client.uploadDialog=OWDialog({follow:b}).posting("正在上传，请稍后 ... ").position();var b=document.getElementById(a.iframeId),c=$(b.contentWindow.document.getElementById("upload_form"));c.submit()},this.uploadCallback=function(a,b){a?(OW.client.uploadDialog.success("上传完毕").position().timeout(2),OW.client.uploadInput.val(b)):OW.client.uploadDialog.error("上传失败",b).position().timeout(3)},this.uploadNotOpen=function(a){$("button[name='"+a+"']").hide()},this.serviceOnline=function(a){var b="1"==a.open?!0:!1,c=a.data||"",d="service-online",e=function(){var b,e,f,g,i,j,k,l,m,n,o,p,r,s,t,h="";try{b=$.parseJSON(c)}catch(q){b=$.parseJSON("[]")}for(e=0;e<b.length;e++)i=unescape(b[e].name||""),j=unescape(b[e].tel||""),k=unescape(b[e].qq||""),l=unescape(b[e].crmqq||""),m=unescape(b[e].wangwang||""),n=unescape(b[e].skype||""),o=unescape(b[e].qrcode||""),p=unescape(b[e].text||""),""!=j&&(j='<dd class="tel">'+j+"</dd>"),""!=k&&(k='<dd class="qq"><a href="http://wpa.qq.com/msgrd?v=3&uin='+k+'&site=qq&menu=yes" target="_blank"></a></dd>'),""!=l&&(l='<dd class="crmqq"><a href="'+l+'" target="_blank"></a></dd>'),""!=m&&(m='<dd class="wangwang"><a target="_blank" href="http://www.taobao.com/webww/ww.php?ver=3&touid='+m+'&siteid=cntaobao&status=1&charset=utf-8"><img border="0" src="http://amos.alicdn.com/realonline.aw?v=2&uid='+m+'&site=cntaobao&s=1&charset=utf-8" alt="点击这里给我发消息" /></a></dd>'),""!=n&&(n='<dd class="skype"><script type="text/javascript" src="http://skype.tom.com/script/skypeCheck40.js"></script><a href="skype:'+n+'?call" onclick="return skypeCheck();"><img src="http://mystatus.skype.com/bigclassic/'+n+'" style="border: none;" width="80" height="24" alt="My status" /></a></dd>'),""!=o&&(o='<dd class="qrcode"><img src="'+o+'" /></dd>'),""!=p&&(p='<dd class="skype">'+p+"</dd>"),g="<dl><dt>"+i+"</dt>"+j+k+l+m+n+o+p+"</dl>",h=""==g?g:h+""+g;f='<div class="'+d+'"><a href="javascript:;" class="mini"></a><div class="listpanel">'+'<div class="heading"><a class="close" href="javascript:;"></a></div>'+'<div class="section">'+h+"</div>"+"</div></div>",$("body").append(f),r=$("div."+d).find(".mini"),s=$("div."+d).find(".listpanel"),t=$("div."+d).find("a.close"),"mini"==a.initType?(r.show(),s.hide()):(r.hide(),s.show()),r.click(function(){r.hide(),s.show("fast")}),t.click(function(){r.show("fast"),s.hide("fast")})};b&&""!=c&&e()}}function ADClass(){this.count=function(){},this.parse=function(a){var b,c,e,d="",f="",g="",h=$("#ow_ad_"+a),i={},j={},k={},l={},m={},n=h.attr("data"),o=h.attr("type"),p=h.attr("ad_height"),q=h.attr("ad_width"),r=OW.int(h.attr("full_screen")),s=OW.int(h.attr("switch_time")),w=-OW.int(q)/2,x="",y="",z="";if(1>s&&(s=6),""!=n)switch(o){case"image":if(e=OW.JSON.parse(n),1==e.length)x=OW.trim(e[0].link),y='target="_blank"',(OW.isNull(x)||"#"==x)&&(z="cursor-default",x="javascript:;",y=""),h.html('<div class="ow-ad-pic"><a class="'+z+'" href="'+x+'" '+y+'><img src="'+e[0].url+'"></a></div>').show(),j=h.find(".ow-ad-pic").css({height:p,width:q}),k=h.find("a").css({height:p,width:q}),l=h.find("img").css({height:p,width:q}),r&&(h.css({width:"100%"}),j.css({overflow:"hidden",position:"absolute",width:"100%"}),k.css({left:"50%","margin-left":w,position:"absolute",width:q}));else if(e.length>1){for(b='<div class="ow-pic-player">',c=0;c<e.length;c++)OW.isNull(e[c].link)||"#"==e[c].link?(z="cursor-default",x="javascript:;",y=""):(z="",x=OW.trim(e[c].link),y='target="_blank"'),d=d+'<li i="'+c+'"><a class="'+z+'" href="'+x+'" '+y+'><img src="'+e[c].url+'"></a><div class="title"><a class="'+z+'" href="'+x+'" '+y+">"+unescape(e[c].name)+"</a></div></li>",f=f+'<a href="javascript:;" i="'+c+'">'+(c+1)+"</a>";b=b+'<ul class="sliders" name="sliders">'+d+"</ul>",b=b+'<div class="pages" name="pages">'+f+"</div>",b+='<div class="turner" name="turner"><a class="prev" href="javascript:;"></a><a class="next" href="javascript:;"></a></div>',b+="</div>",h.html(b).show(),i=h.find(".ow-pic-player").css({height:p,width:q}),$sliders=h.find("ul[name='sliders']").css({height:p,width:q}),l=h.find("img").css({height:p,width:q}),m=h.find("div[name='pages']"),r&&(h.css({width:"100%"}),i.css({width:"100%"}),$sliders.css({left:"50%","margin-left":w}),m.css({left:"50%","margin-left":-OW.int(m.width())/2})),OW.ad.picPlayer({obj:h,timer:1e3*s})}break;case"flash":e=OW.JSON.parse(n),g=e.url,b='<embed src="'+g+'" quality="high" wmode="opaque" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash">',h.html(b).show(),h.find("embed").css({height:p,width:h.css("width")})}},this.picPlayer=function(a){var b,l,m,n,o,c=a.obj,d=a.timer,e=c.find("ul[name='sliders']"),f=c.find("div[name='pages']"),g=c.find("div[name='turner']").hide(),h=g.find("a.prev"),i=g.find("a.next"),j=f.find("a"),k=j.length;e.find("li").hide(),e.find("li:first").show(),f.find("a:first").addClass("current"),h.click(function(){o();var a,b=parseInt(f.find("a.current").attr("i"));a=0==b?k-1:b-1,m(b,a)}),i.click(function(){o();var a,b=parseInt(f.find("a.current").attr("i"));a=b==k-1?0:b+1,m(b,a),n()}),j.click(function(){var a,b;o(),a=parseInt(f.find("a.current").attr("i")),b=parseInt($(this).attr("i")),a!=b&&m(a,b),n()}),l=function(){var a,b=parseInt(f.find("a.current").attr("i"));a=b==k-1?0:b+1,m(b,a)},m=function(a,b){e.find("li:eq("+a+")").hide(),e.find("li:eq("+b+")").fadeIn("fast"),f.find("a:eq("+a+")").removeClass("current"),f.find("a:eq("+b+")").addClass("current")},n=function(){d&&(b=window.clearInterval(b),b=window.setInterval(function(){l()},d))},o=function(){d&&(b=window.clearInterval(b))},c.hover(function(){o(),g.show()},function(){n(),g.hide()}).mouseout()}}function CMTClass(){var a=this;this.pagesize=50,this.countSection={},this.listSection={},this.pagerSection={},this.getCallBack=function(){},this.init=function(b){var f,c=b.cid,d=b.gid,e=OW.cookie.getCookie("avatar");e=OW.iif(OW.isNull(e),OW.siteUrl+"ow-content/images/avatar.jpg",e),f='<div class="ow-owcmt-post"><div class="cmt-avatar"><img src="'+e+'"></div><div class="cmt-post"><textarea class="comment-text" id="ow_oscmt_comment_'+c+"_"+d+'_0" placeholder="说点什么吧" ></textarea></div><div class="cmt-btnline"><a href="javascript:;" onClick="OW.cmt.post({cid:'+c+",gid:"+d+',cmtid:0})" class="btn-owcmt" name="ow_btn_owcmt">发布</a></div></div>',a.postSection.html(f)},this.get=function(b){var c=b.cid,d=b.gid,e=b.page,f=a.countSection,g=a.listSection,h=a.pagerSection;g.html('<div class="ow-data-loading">成交记录加载中...</div>'),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.main.asp?ctl=owcmt&act=get&cid="+c+"&gid="+d+"&page="+e+"&pagesize="+a.pagesize,data:"",success:function(){var b=OW.int(OW.ajaxData.count),c='<div class="ow-owcmt-list">'+unescape(OW.ajaxData.list)+"</div>",d='<div class="ow-owcmt-list-pager">'+unescape(OW.ajaxData.pager)+"</div>";f.html(b),g.hide().html(c).show(200),h.html(d),a.getCallBack()},failed:function(a){g.html("亲，很抱歉，评论数据加载失败，请刷新页面再试试！<br>"+a)}})},this.post=function(b){var h,c=b.cid,d=b.gid,e=b.cmtid,f=$("#ow_oscmt_comment_"+c+"_"+d+"_"+e),g=f.val();OW.isNull(g)?f.focus():(h=OWDialog().posting().position(),OW.ajax({url:OW.siteUrl+"ow-includes/ow.ajax.main.asp?ctl=owcmt&act=post&save=true",data:"cid="+c+"&gid="+d+"&cmtid="+e+"&comment="+escape(g),success:function(){h.success("已发布").position().timeout(2),OW.delay(1e3,function(){f.val(""),OW.cmt.get({cid:c,gid:d,page:a.page})})},failed:function(a){h.error("亲，评论失败，请查看以下原因",a).position().timeout(4)}}))},this.toReply=function(a){var b=a.cid,c=a.gid,d=a.cmtid,e=$("#ow_owcmt_reply_post_"+d),f='<div class="reply-textarea"><input type="text" class="reply-text" id="ow_oscmt_comment_'+b+"_"+c+"_"+d+'" maxlength="250" placeholder="我有话说..." /></div><div class="reply-btnline"><a href="javascript:;" onClick="OW.cmt.post({cid:'+b+",gid:"+c+",cmtid:"+d+'})" class="btn-reply">发布</a></div>';e.find("input").length>0?e.slideUp().html(""):e.html(f).slideDown()}}function linkClass(){this.count=function(a){var b=OW.sitePath+"ow-includes/ow.ajax.main.asp?ctl=link&act=count";OW.ajax({url:b,data:"link_id="+a,success:function(){$dialog.close()},failed:function(a){$dialog.error("亲，提交失败，请查看以下错误信息",a).timeout(5)}})}}function galleryClass(){var a,b,c,d,e,f;this.init=function(g){var h,i,m,n,o,p,r,s,t;a=g.data||"{}",b=g.gallery,c=g.view||$(document.createElement("div")).addClass("gallery-view").attr("create","true"),d=g.list||$(document.createElement("div")).addClass("gallery-list").attr("create","true"),r="",s="",t=!1;try{a=OW.rep(a,"&quot;",'"'),i=OW.JSON.parse(a),i.length>0&&(t=!0)}catch(u){}if(t){for(h=0;h<i.length;h++)m=i[h].url,r=r+'<li><a class="cloud-zoom-gallery" name="cloud_zoom_gallery" bigimg="'+m+'" href="javascript:;" rel="useZoom:\'bigimg_view\',smallImage:\''+m+'\'"><img src="'+m+'" alt="'+i[h].name+'"></a>';s='<a class="turner prev" href="javascript:;" style="display:none;"></a><a class="turner next" href="javascript:;" style="display:none;"></a>',d.append("<ul>"+r+"</ul>"),d.append(s),c.append('<a class="cloud-zoom" name="cloud_zoom" id="bigimg_view" rel="adjustY:0,adjustX:5" bigimg="'+i[0].url+'" href="javascript:;"><img alt="'+i[0].name+'" class="view" src="'+i[0].url+'"></a>'),b.html(""),"true"==d.attr("create")&&(b.append(c),b.append(d)),e=b.find(".prev"),f=b.find(".next"),n=parseInt(b.find(".gallery-list").css("width")),o=parseInt(b.find("li").css("width"))+parseInt(b.find("li").css("margin-right")),p=parseInt(n/o),p<i.length&&b.find(".gallery-list").hover(function(){"0"!=e.attr("valid")&&e.show(),"0"!=f.attr("valid")&&f.show()},function(){e.hide(),f.hide()}),e.click(function(){var a=parseInt(b.find("li[hide='1']").length),c=parseInt(b.find("li[hide!='1']").length);a>0&&(a-=1),b.find("li:eq("+a+")").attr("hide",0).show(200),b.find("li:eq("+(a-1)+")").attr("hide",0).show(200),c+2>p&&f.attr("valid",1).show(200),2>a&&e.attr("valid",0).hide(200)}),f.click(function(){var a=parseInt(b.find("li[hide='1']").length),c=parseInt(b.find("li[hide!='1']").length);c>p&&(b.find("li:eq("+a+")").attr("hide",1).hide(200),b.find("li:eq("+(a+1)+")").attr("hide",1).hide(200)),2>=c-p&&f.attr("valid",0).hide(200),a>0&&e.attr("valid",1).show(200)})}},this.click=function(){b.find(".gallery-list").find("a").click(function(){b.find(".cloud-zoom").find("img").attr("src",$(this).attr("bigimg")),$(this).parents("ul").children("li").removeClass("current"),$(this).parent("li").addClass("current")})},this.cloudZoom=function(a){$(a).CloudZoom()}}function memberClass(){var a=this;this.forgetPassword=function(a){var b=a.tab,c=a.by,d=a.form,e=a.btn,f=d.find("input[name='mobile']"),g=d.find("input[name='mobile_code']"),h=d.find("button[name='get_mobile_code']"),i=d.find("input[name='email']"),j=d.find("span[name='forget_verifycode']"),k=d.find("input[name='verifycode_value']"),l=d.attr("vcode_open");OW.verifyCode({boxer:j}),OW.verifyCodeValueBlur(k),OW.verifyCodeValueFocus(k,j),b.find("a").click(function(){c=$(this).attr("by"),$(this).parent().addClass("current"),b.find("a[by!='"+c+"']").parent().removeClass("current"),"mobile"==c?(d.find("[by='mobile']").show(),d.find("[by='email']").hide()):(d.find("[by='mobile']").hide(),d.find("[by='email']").show())}),OW.getMobileCode({mb:f,mc:g,getmc:h,url:OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=get_forget_mobile_code",vcodeOpen:l,vc:j,vv:k,isHide:!1}),OW.enterClick(function(){e.click()}),e.click(function(){var q,a=!0,b=j.find("input[name='verifycode_name']"),e=OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=forget",h=OW.trim(f.val()),m=OW.trim(g.val()),n=OW.trim(i.val()),o=OW.parseVerifyCode(k.val()),p=OW.trim(b.val());f.val(h),k.val(o),"mobile"==c?(OW.isNull(h)&&(a=!1,f.focus()),OW.isNull(m)&&a&&(a=!1,g.focus())):(OW.isNull(n)&&(a=!1,i.focus()),1==l&&OW.isNull(o)&&a&&(a=!1,k.focus())),a&&(q=OWDialog().posting().position(),OW.ajax({url:e,data:"by="+c+"&mobile="+OW.encrypt.encode(h)+"&mobile_code="+OW.encrypt.encode(m)+"&account="+OW.encrypt.encode(n)+"&verifycode_name="+p+"&verifycode_value="+o,success:function(){var a,b,e;q.close(),"email"==c?(a=unescape(OW.trim(OW.ajaxData.html)),d.html('<div class="success-tip">'+a+"</div>")):(b=OW.int(OW.ajaxData.uid),e=OW.trim(OW.ajaxData.hash),OW.openPage(OW.siteUrl+"?ctl=forget_password&act=reset&hash="+e+"&uid="+b))},failed:function(a){OW.verifyCode({boxer:j}),k.val("").focus(),q.error("亲，提交失败，请查看以下错误信息",a).position().timeout(3)}}))})},this.forgetPasswordReset=function(a){var b=a.form,c=a.btn,d=b.attr("uid"),e=b.attr("hash"),f=b.find("input[name='password']"),g=b.find("input[name='repassword']"),h=b.find("span[name='forget_verifycode']"),i=b.find("input[name='verifycode_value']"),j=b.attr("vcode_open");OW.verifyCode({boxer:h}),OW.verifyCodeValueBlur(i),OW.verifyCodeValueFocus(i,h),OW.enterClick(function(){c.click()}),c.click(function(){var a=!0,b=!0,c=OWDialog().posting().position();$vcodeName=h.find("input[name='verifycode_name']"),url=OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=forget_reset",pw=OW.trim(f.val()),rp=OW.trim(g.val()),vv=OW.parseVerifyCode(i.val()),vn=OW.trim($vcodeName.val()),f.val(pw),g.val(rp),i.val(vv),OW.isNull(pw)&&(a=!1,f.focus()),OW.isNull(rp)&&a&&(a=!1,g.focus()),1==j&&OW.isNull(vv)&&a&&(a=!1,i.focus()),pw!=rp&&a&&(a=!1,b=!1,c.alert("两次输入的密码不一致，请重新输入！").position().timeout(2),g.addClass("text-err").val("").focus()),a?OW.ajax({url:url,data:"uid="+OW.encrypt.encode(d)+"&hash="+escape(e)+"&password="+OW.encrypt.encode(pw)+"&verifycode_name="+vn+"&verifycode_value="+vv,success:function(){c.success("亲，您已成功设置新密码！").position().timeout(2),OW.redirect(OW.siteUrl,2)},failed:function(a){OW.verifyCode({boxer:h}),i.val("").focus(),c.error("亲，提交失败，请查看以下错误信息",a).position().timeout(3)}}):b&&c.close()})},this.getMyPoint=function(){var a=0;return OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=get_my_point",async:!1,success:function(){a=OW.ajaxData.my_point}}),a},this.isLogined=function(){return OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=is_logined",data:"",async:!1,success:function(){"true"==OW.ajaxData.logined&&(OW.logined=!0)}}),OW.logined},this.loginInit=function(a){var b=!0,c=a.username,d=a.password,e=a.vcodeValue,f=a.verifycode,g=OW.cookie.getCookie("last_login_user")||"";""!=g&&c.val(g),""==OW.trim(c.val())&&(b=!1,c.focus()),""==OW.trim(d.val())&&b&&(b=!1,d.focus()),""==OW.trim(e.val())&&b&&(b=!1,e.focus(),OW.verifyCode({boxer:f})),OW.verifyCodeValueBlur(e),OW.verifyCodeValueFocus(e,f)},this.loginSuccessCallBack={},this.login=function(b){var d=OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=login",e=!0,f={},g=b.btnLogin,h=b.username,i=b.password,j=b.verifycode,k=b.vcodeValue,l=j.find("input[name='verifycode_name']"),m=b.remember,n=b.success?b.success:"",o=b.vcode_open,p=OW.trim(h.val()),q=OW.trim(i.val()),r=OW.parseVerifyCode(k.val()),s=OW.trim(l.val());k.val(r);try{f=OWDialog({id:"d_logining",close:!1}).posting("登录中...").reset()}catch(t){return!1}e&&OW.setDisabled(g,!0),""==p&&e?(e=!1,h.addClass("text-err").focus()):h.removeClass("text-err"),""==q&&e?(e=!1,i.addClass("text-err").focus()):i.removeClass("text-err"),1==o&&(""==r&&e?(e=!1,k.addClass("text-err").focus()):k.removeClass("text-err")),e?OW.ajax({url:d,data:"username="+OW.encrypt.encode(p)+"&password="+OW.encrypt.encode(q)+"&verifycode_name="+s+"&verifycode_value="+r,success:function(){var b=OW.cookie.getCookie("login_return_url");if(b=OW.iif(OW.isNull(b),OW.sitePath+"ow-ucenter/",b),OW.logined=!0,1==m.attr("checked")&&OW.cookie.setCookie("last_login_user",p),OW.isNull(n))f.success("登陆成功，正在跳转...").position(),OW.openPage(b);else{f.close(),a.userStatus({});try{a.loginWin.close()}catch(c){}try{n.call()}catch(c){}}},failed:function(a){OW.verifyCode({boxer:j}),OW.setDisabled(g,!1),k.val("").focus(),f.error("亲，登陆失败，请查看以下错误信息",a).fixTop(60).timeout(2)}}):(f.close(),OW.setDisabled(g,!1))},this.loginWin,this.loginWindow=function(){return OW.shoppingIsNeedLogin?OW.openPage(OW.loginUrl):(OW.cookie.setCookie("unlogin_buy","1"),OW.openPage(OW.loginUrl)),!1},this.loginWindowLogining=function(a){OW.member.login({username:$("#login_win_form").find("input[name='username']"),password:$("#login_win_form").find("input[name='password']"),verifycode:$("#login_win_form").find("span[name='verifycode']"),vcodeValue:$("#login_win_form").find("input[name='verifycode_value']"),remember:$("#login_win_form").find("input[name='remember']"),btnLogin:$("#login_win_form").find("button[name='btn_login']"),success:a.success})},this.regInit=function(a){var b=a.form,c=b.find("input[name='mobile']"),d=b.find("input[name='mobile_code']"),e=b.find("button[name='get_mobile_code']"),f=b.find("span[name='reg_verifycode']"),g=b.find("input[name='verifycode_value']"),h=b.find("input[name='username']"),i=b.attr("vcode_open");OW.objExist(h)&&h.blur(function(){$(this).val(OW.parseUsername($(this).val()))}),OW.objExist(c)&&OW.getMobileCode({mb:c,mc:d,getmc:e,url:OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=get_reg_mobile_code",vcodeOpen:i,vc:f,vv:g,isHide:!0})},this.reg=function(a){var c=OW.sitePath+"ow-includes/ow.ajax.member.asp?ctl=member&act=reg",d=!0,e=!0,f=OWDialog({close:!1}).posting("提交注册中..."),g=a.form,h=g.find("input[name='mobile']"),i=g.find("input[name='mobile_code']"),j=g.find("input[name='username']"),k=g.find("input[name='fullname']"),l=g.find("input[name='email']"),m=g.find("input[name='password']"),n=g.find("input[name='repassword']"),o=g.find("input[name='recommend_user']"),p=a.btnReg,q=a.verifycode,r=a.vcodeValue,s=q.find("input[name='verifycode_name']"),t=a.vcode_open,u="",v="",w=OW.trim(j.val()),x=OW.trim(k.val()),y=OW.trim(l.val()),z=OW.trim(m.val()),B=(OW.trim(n.val()),OW.trim(r.val())),C=OW.trim(s.val()),D=OW.iif(OW.objExist(o),OW.trim(o.val()),"");d&&OW.setDisabled(p,!0),OW.objExist(h)&&(u=OW.parseMobile(OW.trim(h.val())),v=OW.trim(i.val()),!OW.isValidMobile(u)&&d?(d=!1,h.addClass("text-err").focus()):h.removeClass("text-err"),""==v&&d?(d=!1,i.addClass("text-err").focus()):i.removeClass("text-err")),OW.objExist(j)&&(""==w&&d?(d=!1,j.addClass("text-err").focus()):j.removeClass("text-err")),OW.objExist(k)&&(OW.isNull(x)&&d?(d=!1,k.addClass("text-err").focus()):k.removeClass("text-err")),OW.objExist(l)&&(""==y&&d?(d=!1,l.addClass("text-err").focus()):l.removeClass("text-err")),""==z&&d?(d=!1,m.addClass("text-err").focus()):m.removeClass("text-err"),OW.objExist(o)&&1==OW.int(o.attr("is_reg_recommend_open_required"))&&(""==D&&d?(d=!1,o.addClass("text-err").focus()):o.removeClass("text-err")),OW.objExist(h)||1==t&&(""==B&&d?(d=!1,r.addClass("text-err").focus()):r.removeClass("text-err")),d?OW.ajax({url:c,data:"mobile="+OW.encrypt.encode(u)+"&mobile_code="+OW.encrypt.encode(v)+"&username="+OW.encrypt.encode(w)+"&fullname="+OW.encrypt.encode(x)+"&password="+OW.encrypt.encode(z)+"&email="+OW.encrypt.encode(y)+"&verifycode_name="+C+"&verifycode_value="+B+"&recommend_user="+OW.encrypt.encode(D),success:function(){OW.cookie.setCookie("last_login_user",w),f.success("亲，恭喜您注册成功！").position().timeout(2),window.location.href=OW.sitePath+"ow-ucenter/regboot.asp?ctl=regsuccess"},failed:function(a){OW.verifyCode({boxer:q}),OW.setDisabled(p,!1),r.val("").focus(),f.error("亲，注册失败，请查看以下错误信息",a).position().timeout(3)}}):(e&&f.close(),OW.setDisabled(p,!1))},this.userStatusSection="",this.userStatus=function(b){var c=b.userStatusSection?b.userStatusSection:a.userStatusSection;a.userStatusSection=c,OW.uid=OW.int(OW.cookie.getCookie("uid")),OW.username=OW.trim(OW.cookie.getCookie("username")),OW.nickname=OW.trim(OW.cookie.getCookie("nickname")),OW.uid>0&&""!=OW.username&&1==OW.logined&&c.html('<a href="'+OW.sitePath+'ow-ucenter/" class="username">'+OW.iif(OW.isNull(OW.nickname),OW.username,OW.nickname)+'</a><a class="logout" href="'+OW.logoutUrl+'">退出</a>')},this.wxLogin=function(){OW.openPage(OW.siteUrl+"ow-includes/module/login/weixin/")},this.qqLogin=function(a){var b=a.appid||"",c=OW.urlEncode(OW.siteUrl+"ow-includes/module/login/qq/index.asp");OW.openPage("https://graph.qq.com/oauth2.0/authorize?response_type=code&client_id="+b+"&redirect_uri="+c+"&scope=get_user_info")}}function searchClass(){this.display=function(a){var a=OW.int(a);$dialog=OWDialog({close:!1}).loading("loading").position(),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.main.asp?ctl=get_search_html&is_shop="+a,data:"",success:function(){$dialog.close(),$("#ow_search").remove();var a=unescape(OW.ajaxData.html);$("body").append(a),$("#ow_search").show(),$("#ow_search_close").click(function(){$("#ow_search").hide()})},failed:function(a){$list.html("搜索数据加载失败，请刷新试试！<br>"+a)}})},this.run=function(a){var e,f,g,b=OW.search.run.arguments,c=OW.search.run.arguments.length,d="keywords";c>=2&&(d=b[1]),e=$("input[name='"+d+"']"),f=OW.trim(e.val()),g=OW.siteUrl+"?ctl=search&is_shop={$is_shop}&keyword={$keyword}&page={$page}",e.val(f),""==f?e.focus():(g=g.replace("{$is_shop}",a).replace("{$keyword}",f).replace("{$page}",1),OW.redirect(g,0))}}function shopClass(){var a=this;this.dialog={},this.pid=0,this.productSn="",this.productStock=0,this.productsData="",this.goodsMyPrice=0,this.MGPricesHtml="",this.specCount=0,this.cartAmountSection={},this.priceSection={},this.marketPriceSection={},this.myPriceSection={},this.pointSet=0,this.pointPayAmount=0,this.isBook=0,this.bookFrontMoneyRate=0,this.bookPriceDiscount=0,this.bookPriceSection={},this.bookTimeSection={},this.bookMoneySection={},this.amountInput={},this.specSection={},this.stockTipSection={},this.cartGoods={},this.cartPriceSum={},this.cartData=[],this.addToCart=function(a,b,c,d,e){var f,g,h,i,j,k;a=OW.int(a),b=OW.int(b),c=OW.int(c),d=OW.int(d),a>0&&(d=1),k=OWDialog().loading("加载中...").position(),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=cart&act=get_cart_data",data:"",async:!1,success:function(){var l=!1;for(j=OW.ajaxData.cart_data,i={suit_id:""+a,gid:""+b,pid:""+c,m:""+d},g=j,f=0;f<g.length;f++)if(g[f].suit_id==a&&g[f].gid==b&&g[f].pid==c){g[f].m=OW.toString(OW.int(g[f].m)+d),h=OW.JSON.toString(g),l=!0;break}l?(k.success("商品已在购物车中！").timeout(2),e.call()):(g.push(i),h=OW.JSON.toString(g),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=cart&act=save_cart_data",data:"cart_data="+h,async:!1,success:function(){OW.cookie.setCookie("cart",h,10368e5),k.success("商品已成功加入购物车！").timeout(2).shadow(!1),e.call()}}))}})},this.addToFavorite=function(a){if(a=OW.int(a),!OW.logined)return OW.member.loginWindow({success:function(){OW.shop.addToFavorite(a)}}),!1;var b=OWDialog().posting();OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=add_to_favorite",data:"gid="+a,success:function(){b.success("成功添加至收藏夹！").timeout(2)},failed:function(a){b.error("亲，很抱歉，添加至收藏夹失败，请查看以下原因！",a).timeout(3)}})},this.author=function(){var a=">l>i>n>x>i>a>o>d>o>n>g>";return OW.rep(a,">","")},this.cartInit=function(b){var c,d,e=b.cartAmountSection||a.cartAmountSection,f=OW.cookie.getCookie("cart");a.cartAmountSection=e,OW.isNull(f)?c=0:(d=OW.JSON.parse(f),c=OW.int(d.length)),e.html(c)},this.cartPageInit=function(b){var c,d,e,f,g=b.cart,h=b.btn.addClass("disabled").attr("disabled",!0),i=OWDialog({close:!1}).loading().position();OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=cart&act=get_cart_goods",success:function(){return i.close(),f=OW.ajaxData.cart_json,e=OW.ajaxData.cart_html,OW.isNull(f)?(OW.cookie.remove("cart"),!1):(g.html(unescape(e)),d=OW.JSON.toString(f),c=g.find("input[name='check_all']"),a.cartGoods=g.find("div[name='cart_goods_list']"),a.cartPriceSum=b.cartPriceSum,a.cartPriceCount(),OW.cookie.setCookie("cart",d,10368e5),c.click(function(){var b=a.cartGoods.find("ul[name='item']");$checkbox=a.cartGoods.find("input[name='items[]']"),1==$(this).attr("checked")?(b.addClass("current"),$checkbox.attr("checked",!0)):(b.removeClass("current"),$checkbox.attr("checked",!1)),a.cartPriceCount()}),a.cartGoods.find("input[name='items[]']").click(function(){var b=$(this).parent().parent().parent();1==$(this).attr("checked")?b.addClass("current"):b.removeClass("current"),a.cartPriceCount()}),a.cartGoods.find("input[name='amount_input']").blur(function(){var b=OW.int($(this).val()),c=OW.int($(this).attr("suit_id"));1>b&&(b=1),$(this).val(b),a.cartPriceCount(),a.gartGoodsAmountChange($(this).attr("gid"),$(this).attr("pid"),b),c>0&&a.cartGoods.find("[name='suit_amount'][suit_id='"+c+"']").html(b)}),a.cartGoods.find("a[name='amount_decrease']").click(function(){var b=$(this).parent().find("input[name='amount_input']"),c=OW.int(b.attr("suit_id")),d=OW.int(b.val())-1;1>d&&(d=1),b.val(d),a.cartPriceCount(),a.gartGoodsAmountChange(b.attr("gid"),b.attr("pid"),d),c>0&&a.cartGoods.find("[name='suit_amount'][suit_id='"+c+"']").html(d)}),a.cartGoods.find("a[name='amount_increase']").click(function(){var b=$(this).parent().find("input[name='amount_input']"),c=OW.int(b.attr("suit_id")),d=OW.int(b.val())+1;b.val(d),a.cartPriceCount(),a.gartGoodsAmountChange(b.attr("gid"),b.attr("pid"),d),c>0&&a.cartGoods.find("[name='suit_amount'][suit_id='"+c+"']").html(d)}),OW.int(a.cartGoods.find("input[name='items[]']").length)>0&&h.removeClass("disabled").attr("disabled",!1),void 0)},failed:function(a){i.error("亲，很抱歉，加载购物车数据失败，请刷新页面再试试！",a).timeout(3)}}),h.click(function(){var b,c,d,e,f;return OW.logined||1==OW.int(OW.cookie.getCookie("unlogin_buy"))?OW.int(a.cartGoods.find("input[name='items[]']:checked").length)<1?(OWDialog().alert("请至少选中一件商品！"),!1):(a.cartGoods.find("input[name='items[]']:checked").each(function(){suitId=OW.int($(this).attr("suit_id")),b=OW.int($(this).attr("gid")),c=OW.int($(this).attr("pid")),d=OW.int($(this).parent().parent().parent().find("input[name='amount_input']").val()),f='{"suit_id":"'+suitId+'","gid":"'+b+'","pid":"'+c+'","m":"'+d+'"}',e=OW.isNull(e)?f:e+","+f}),e="["+e+"]",a.cartOrderSubmit({data:e}),void 0):(OW.member.loginWindow({success:function(){OW.refresh()}}),!1)})},this.cartPriceCount=function(){var b,c,d,e=0,f=a.cartGoods.find("input[name='items[]']:checked").parent().parent().find("input[name='amount_input']");f.each(function(){b=OW.int($(this).val()),c=OW.parseFloat($(this).attr("price")),d=OW.parseFloat(c*b),e+=d,$(this).parent().parent().parent().parent().find("[name='item_sum']").html(OW.parsePrice(d))}),a.cartPriceSum.html(OW.parsePrice(e))},this.cartOrderSubmit=function(a){var b,c,d=a.data,e=OW.int(a.is_book),f=OW.int(a.order_type),g='<form name="order_data_form" method="post"><input type="hidden" name="order_type" value="'+f+'" /><input type="hidden" name="is_book" value="'+e+'" /><input type="hidden" name="order_goods_data" value="" /></form>';OW.objExist($("form[name='order_data_form']"))||$("body").append(g),b=$("form[name='order_data_form']"),c=b.find("input[name='order_goods_data']").val(d),b.attr("action",OW.siteUrl+"?ctl=order&act=init").submit()},this.invoiceEditWin,this.invoiceData,this.invoiceEdit=function(b){var c,d,e,i,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;return OW.objExist($("#invoice_edit_html"))?!1:(c=b.isInvoiceVatOpen||0,OW.appendToString="",OW.append('<div class="invoice-edit-html" id="invoice_edit_html">'),OW.append('<div class="invoice-edit-header"><ul class="selected-style invoice-type"><li name="invoice_type" value="1"><span>普通发票</span></li><li name="invoice_type" value="2" '),0==c&&OW.append('style="display:none;"'),OW.append("><span>增值税专用发票</span></li></ul></div>"),OW.append('<div class="invoice-edit-section">'),OW.append('<div name="invoice_type" value="1"><dl><dt><i class="important">*</i>单位名称(发票抬头)</dt><dd><input type="text" class="text" datatype="*" errmsg="请填写发票抬头" name="invoice_title" maxlength="250" value="" /><span class="t-normal ml5" name="t_invoice_title"></span></dd></dl><dl><dt><i class="important">*</i>纳税人识别号</dt><dd><input type="text" class="text" datatype="*" errmsg="请填写纳税人识别号" name="invoice_code" maxlength="50" value="" /><span class="t-normal ml5" name="t_invoice_code"></span></dd></dl><dl><dt><i class="important">*</i>发票内容</dt><dd><ul class="selected-style invoice-content-type"><li name="invoice_content_type" value="1"><span>明细</span></li><li name="invoice_content_type" value="2"><span>自填</span></li></ul></dd><dd name="invoice_conent_type" style="display:none;"><input type="text" class="text" name="invoice_content" maxlength="250" value="" /><span class="t-normal ml5" name="t_invoice_content"></span></dd></dl></div>'),OW.append('<div name="invoice_type" value="2" style="display:none;"><dl><dt><i class="important">*</i>注册地址</dt><dd><input type="text" class="text" datatype="*" errmsg="请填写注册地址" name="invoice_address" maxlength="250" value="" /><span class="t-normal ml5" name="t_invoice_address"></span></dd></dl><dl><dt><i class="important">*</i>注册电话</dt><dd><input type="text" class="text" datatype="*" errmsg="请填写注册电话" name="invoice_phone" maxlength="100" value="" /><span class="t-normal ml5" name="t_invoice_phone"></span></dd></dl><dl><dt><i class="important">*</i>开户银行</dt><dd><input type="text" class="text" datatype="*" errmsg="请填写开户银行" name="invoice_bank_name" maxlength="100" value="" /><span class="t-normal ml5" name="t_invoice_bank_name"></span></dd></dl><dl><dt><i class="important">*</i>银行账户</dt><dd><input type="text" class="text" datatype="*" errmsg="请填写银行账号" name="invoice_bank_account" maxlength="30" value="" /><span class="t-normal ml5" name="t_invoice_bank_account"></span></dd></dl></div></div>'),OW.append('<div class="invoice-edit-footer"><button type="button" class="btn btn-primary" name="btn_submit">保存发票信息</button></div>'),OW.append("</div>"),d=OW.appendToString,e=$("#invoice"),e.append(d),f=$("#order_invoice"),g=$("#invoice_edit_html"),h=f.find("input[name='invoice']"),j=h.val(),OW.isNull(j)&&(j='{"invoice_type":"1"}'),i=OW.JSON.parse(j),k=i.invoice_type||1,l=i.invoice_title||"",m=i.invoice_content_type||1,n=i.invoice_content||"",o=i.invoice_code||"",p=i.invoice_address||"",q=i.invoice_phone||"",r=i.invoice_bank_name||"",s=i.invoice_bank_account||"",t=$("input[name='invoice_title']").val(unescape(l)),u=$("input[name='invoice_content']").val(unescape(n)),v=$("span[name='t_invoice_content']"),w=$("input[name='invoice_code']").val(unescape(o)),x=$("input[name='invoice_address']").val(unescape(p)),y=$("input[name='invoice_phone']").val(unescape(q)),z=$("input[name='invoice_bank_name']").val(unescape(r)),A=$("input[name='invoice_bank_account']").val(unescape(s)),B=g.find("button[name='btn_submit']"),g.find("li[name='invoice_type'][value='"+k+"']").addClass("current"),2==k&&g.find("div[name='invoice_type'][value='2']").show(),g.find("li[name='invoice_content_type'][value='"+m+"']").addClass("current"),2==m&&g.find("dd[name='invoice_conent_type']").show(),g.find("li[name='invoice_type']").click(function(){var b=$(this).attr("value");$(this).addClass("current"),$(this).siblings("li[name='invoice_type'][value!='"+b+"']").removeClass("current"),2==b?(a.taxrate=a.needInvoiceInput.attr("invoice_vat_taxrate"),g.find("div[name='invoice_type'][value='2']").show()):(a.taxrate=a.needInvoiceInput.attr("taxrate"),g.find("div[name='invoice_type'][value='2']").hide()),$("#taxrate_show").html("税率"+a.taxrate+"%"),a.costInvoiceCount(),a.totalAmountCount()}),g.find("li[name='invoice_content_type']").click(function(){var a=$(this).attr("value");$(this).addClass("current"),$(this).siblings("li[name='invoice_content_type'][value!='"+a+"']").removeClass("current"),2==a?g.find("dd[name='invoice_conent_type']").show():g.find("dd[name='invoice_conent_type']").hide()}),B.click(function(){var d,e,i,a=g,b=g.find("li[name='invoice_type'][class='current']"),c=g.find("li[name='invoice_content_type'][class='current']");"1"==b.attr("value")&&(a=g.find("div[name='invoice_type'][value='1']")),d=OWValidForm({form:a}),d.verify(),d.result&&2==g.find("li[name='invoice_content_type'][class='current']").attr("value")&&(""==OW.trim(u.val())?(u.focus(),v.addClass("t-err").html("请填写发票内容"),d.result=!1):v.removeClass("t-err").html("")),d.result&&(e='{"invoice_type":"'+escape(b.attr("value"))+'","invoice_title":"'+escape(t.val())+'","invoice_content_type":"'+escape(c.attr("value"))+'","invoice_content":"'+escape(u.val())+'","invoice_code":"'+escape(w.val())+'","invoice_address":"'+escape(x.val())+'","invoice_phone":"'+escape(y.val())+'","invoice_bank_name":"'+escape(z.val())+'","invoice_bank_account":"'+escape(A.val())+'"}',i=OWDialog().posting().position(),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=invoice&act=edit",data:"invoice_data="+e,success:function(){g.remove(),h.val(e),f.find("[name='invoice_type']").html(b.find("span").html()),f.find("[name='invoice_title']").html(t.val()+"<em>"+w.val()+"</em>"),2==c.attr("value")?f.find("[name='invoice_content']").html(u.val()):f.find("[name='invoice_content']").html("明细"),i.success("修改成功").position().timeout(2)
},failed:function(a){g.remove(),h.val(e),f.find("[name='invoice_type']").html(b.find("span").html()),f.find("[name='invoice_title']").html(t.val()+"<em>"+w.val()+"</em>"),2==c.attr("value")?f.find("[name='invoice_content']").html(u.val()):f.find("[name='invoice_content']").html("明细"),OW.logined?i.error("亲，很抱歉，修改失败，请查看以下信息！",a).position().timeout(3):i.close()}}))}),void 0)},this.taxrate=0,this.costItem=0,this.costInvoice=0,this.costCoupon=0,this.costFreight=0,this.freeFreightAmount=0,this.totalAmount=0,this.totalAmountSection={},this.needInvoiceInput={},this.costFreightSection={},this.costInvoiceSection={},this.totalAmountCount=function(){a.costItem<a.costCoupon&&(a.costCoupon=a.costItem),a.totalAmount=OW.parseMoney(a.costItem)-OW.parseMoney(a.costCoupon)+OW.parseMoney(a.costInvoice)+OW.parseMoney(a.costFreight),a.totalAmount<0&&(a.totalAmount=0),a.totalAmountSection.html(OW.parsePrice(a.totalAmount))},this.costInvoiceCount=function(){var b,c;b=OW.parseMoney(a.costItem),b<a.costCoupon&&(a.costCoupon=b),1==a.needInvoiceInput.attr("checked")&&(c=b-OW.parseMoney(a.costCoupon),1==OW.isCostFreightInvoice&&(c+=OW.parseMoney(a.costFreight)),a.costInvoice=OW.countInvoiceFee(a.taxrate,c),a.costInvoiceSection.attr("money",a.costInvoice).html(OW.parsePrice(a.costInvoice)))},this.orderDlyTrigger=function(){var b=$("#order_dly"),c=b.find("input[name='order_dly']");c.length>0?(1==a.isOffline?b.hide():b.show(),c.click(function(){a.costFreight=OW.parseMoney($(this).attr("dly_fee")),a.costFreightSection.html(OW.parsePrice(a.costFreight)),a.costInvoiceCount(),a.totalAmountCount()})):b.hide()},this.isOffline=!1,this.orderOfflineTrigger=function(){var b=$("#order_offline_select");b.click(function(){var b=OWDialog({id:"d_offline_select",title:"选择自提点",content:'<div class="ow-order-offline-diawin" id="ow_offline">loading ... </div>',padding:"0px",initialize:function(){},ok:function(){var b=$("#ow_offline").find("input:checked"),c=$("input[name='order_offline_store']"),d=$("#order_offline_info");return $("#order_dly"),OW.objExist(b)?(c.val(OW.int(b.val())),d.html(b.attr("store_name")+"（"+b.attr("store_address")+"）"+'<a class="offline-cancel" href="javascript:;" id="offline_cancel">取消</a>'),a.isOffline=!0,$("#order_dly").hide(),a.costFreight=0,a.costFreightSection.html(OW.parsePrice(a.costFreight)),a.costInvoiceCount(),a.totalAmountCount(),$("#offline_cancel").click(function(){c.val(0),d.html(""),a.isOffline=!1,$("#order_dly").show(),$("#order_dly").find("input[name='order_dly']:eq(0)").click()}),void 0):(alert("请选择自提点"),!1)},okValue:"确定选择",cancel:!0,cancelValue:"关闭"});b.footerFix({height:"60%"}),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=order&act=get_offline_html",data:"",async:!1,success:function(){$("#ow_offline").html(unescape(OW.ajaxData.html)),$("#ow_offline").find("input").click(function(){1==$(this).attr("checked")&&($(this).parent().parent().addClass("current"),$(this).parent().parent().siblings().removeClass("current"))})}})})},this.formDataTrigger=function(){$(".ow-order-formdata-list").find("ul").hide(),$("a[name='select_formdata']").click(function(){var a=$(this),b=$(this).next("ul");OW.shop.dialog=OWDialog({id:"d_data_select",title:"选择收货地址",content:'<div class="ow-order-formdata-list" id="ow_formdata_diawin">loading ... </div>',padding:"0px",initialize:function(){$("#ow_formdata_diawin").html(b.show())},beforeClose:function(){a.parent().append(b.hide())},cancel:!0,cancelValue:"关闭"}),OW.shop.dialog.footerFix({height:"60%"})})},this.orderInit=function(b){var c=b.order,d=b.btn,e=b.costItem,f=b.costCoupon,g=b.costFreight,h=b.costInvoiceGrid,i="",j=$("#order_coupon").find("input[name='coupon']"),k=c.find("form"),l=$("div[name='order_dly_section']"),m=$("div[name='order_invoice_section']"),o=(OW.iif(c.find("select[is_region='1']").length>0,!0,!1),$("#order_region_select_grid").attr("region_data"));a.needInvoiceInput=$("input[name='need_invoice']"),a.taxrate=OW.iif(1==OW.int(a.needInvoiceInput.attr("invoice_type")),a.needInvoiceInput.attr("taxrate"),a.needInvoiceInput.attr("invoice_vat_taxrate")),a.costItem=OW.parseMoney(e.attr("money")),a.costFreight=OW.parseMoney(g.attr("money")),a.costFreightSection=b.costFreight,a.costInvoiceSection=b.costInvoice,a.totalAmountSection=b.totalAmount,a.orderSubmitFun=b.orderSubmitFun||"",a.orderSuccessFun=b.orderSuccessFun||"",a.orderId="",c.find("input[name='order_formdata_select']").click(function(){var b=($(this).val(),$(this).attr("form_id")),c=$(this).attr("region_data"),d=$(this).parent(),e=$("form[form_id='"+b+"']");d.find("span").each(function(){var a=$(this).attr("field"),b=$(this).html();e.find("[name='"+a+"']").val(b)}),$("#order_region_select_grid").html(""),OW.createRegionSelect($("#order_region_select_grid"),"order_region",c),OW.shop.dialog.close()}),$("#order_goods_info").find("input[name='item[goods]']").length<1&&d.addClass("disabled").attr("disabled",!0),OW.regionSelectFinished=function(b){var c="goods_data="+OW.parseVal($("input[name='order_goods_data']").val())+"&path="+b,d=OWDialog({close:!1}).loading();OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=order&act=get_order_dly",data:c,success:function(){d.close(),l.html(unescape(OW.ajaxData.dly_html)),a.freeFreightAmount=OW.parseMoney(OW.ajaxData.shopping_free_freight_amount),a.freeFreightAmount>0&&a.costItem>=a.freeFreightAmount?(a.costFreight=0,$("#order_dly").find("input[name='order_dly']").attr("dly_fee","0"),$("#order_dly").find("em[name='freight']").html("")):a.costFreight=OW.parseMoney(OW.ajaxData.dly_fee),g.html(OW.parsePrice(a.costFreight)),a.orderDlyTrigger(),a.costInvoiceCount(),a.totalAmountCount()},failed:function(a){d.error("亲，很抱歉，获取运费失败，请重新试试！",a).position().timeout(4)}})},OW.objExist($("#order_region_select_grid"))&&OW.createRegionSelect($("#order_region_select_grid"),"order_region",o),a.formDataTrigger(),a.orderDlyTrigger(),a.orderOfflineTrigger(),a.needInvoiceInput.attr("checked",!1),a.needInvoiceInput.click(function(){costCoupon=parseFloat(f.attr("money")),1==$(this).attr("checked")?(a.costInvoiceCount(),m.show(),h.show(50)):(a.costInvoice=0,m.hide(),h.hide(50),a.costInvoiceSection.attr("money",0).html(0)),a.totalAmountCount()}),$("#order_coupon").find("li[name='coupon']").click(function(){var b=OW.int($(this).attr("is_can_mix_use")),c=$(this).attr("selected");1==c?$(this).removeClass("current").attr("selected",0):(0==b&&$(this).siblings("li[is_can_mix_use='0']").removeClass("current").attr("selected",0),$(this).addClass("current").attr("selected",1)),i="",a.costCoupon=0,$("#order_coupon").find("li[name='coupon'][selected=1]").each(function(){i=OW.isNull(i)?$(this).attr("coupon_code"):i+","+$(this).attr("coupon_code"),a.costCoupon=a.costCoupon+OW.parseMoney($(this).attr("coupon_money"))}),j.val(i),a.costInvoiceCount(),a.totalAmountCount(),f.attr("money",a.costCoupon).html(OW.parsePrice(a.costCoupon))}),d.click(function(){var b,d,e,f,g,h,i,j,l,m,n,o,q,r,t,u,v,w='"region_data":""',x=!0,y=!0,z=c.find("select[is_region='1']"),A=$("span[name='t_order_region']");z.length>0&&(A.removeClass("t-err").html(""),z.each(function(){!OW.int($(this).val())>0&&(x=!1,$(this).focus(),A.addClass("t-err").html("请先选择配送地区！")),w='"region_data":"'+$(this).find("option:selected").attr("path")+'"'})),x?k.each(function(){t=OWValidForm({form:$(this)}),t.verify(),t.getFormData(),t.result||(y=!1),e=OW.isNull(e)?t.formJsonData:e+","+t.formJsonData}):y=!1,"function"==typeof a.orderSubmitFun&&y&&(y=a.orderSubmitFun.call(this)),y&&(v=(new OWDialog).posting("亲，您的的订单正在提交，请稍后...").position(),u=c.find("input[name='item[goods]']"),u.each(function(){q='{"suit_id":"'+OW.int($(this).attr("suit_id"))+'","gid":"'+$(this).attr("gid")+'","pid":"'+$(this).attr("pid")+'","m":"'+$(this).attr("amount")+'"}',r=OW.isNull(r)?q:r+","+q}),e=OW.isNull(e)?"":","+e,h=OW.trim($("#order_invoice").find("input[name='invoice']").val()),g=1==$("#order_invoice").find("input[name='need_invoice']").attr("checked")?1:0,j='"offline_store_id":"'+OW.iif(a.isOffline,OW.int($("input[name='order_offline_store']").val()),"0")+'"',l='"order_dly_id":"'+OW.int($("#order_dly").find("input[name='order_dly']:checked").val())+'"',h=OW.isNull(h)?"{}":h,h='"is_need_invoice":"'+g+'","invoice":'+h,i=OW.trim($("#order_coupon").find("input[name='coupon']").val()),i='"coupon":"'+i+'"',m='"remark":"'+escape(OW.trim(c.find("input[name='remark']").val()))+'"',n=OW.trim(c.find("input[name='aux_data']").val()),n='"aux_data":"'+n+'"',f=OW.int(c.find("input[name='is_book']").val()),o='{"is_book":"'+f+'","order_type":"0","goods":['+r+"]"+e+","+w+","+j+","+l+","+h+","+i+","+m+","+n+"}",d="order_data="+escape(o),b="payment",OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=order&act=order",data:d,success:function(){var c=!0;a.orderId=OW.ajaxData.order_id,"function"==typeof a.orderSuccessFun&&(c=a.orderSuccessFun.call(this)),c&&(OW.redirect(OW.siteUrl+"?ctl=order&act="+b+"&order_id="+a.orderId),OW.cookie.remove("cart"),v.timeout(2))},failed:function(a){v.error("亲，很抱歉，订单提交失败，请查看以下信息！",a).position().timeout(4)}}))})},this.orderPayment=function(a){var b=a.orderId,d=(a.isBook,parseFloat(a.costPay)),e=parseFloat(a.totalAmount),f=parseFloat(a.bookFinalMoney),g=a.$payment,h=a.$costPay,i=a.$totalAmount,j=a.$btn,k=a.$bookFinalMoney;g.find("input[name='payment']").click(function(){var a=parseFloat($(this).attr("pay_fee")),b=e-d+a;h.html(OW.parsePrice(a)),i.html(OW.parsePrice(b)),k.html(OW.parsePrice(f-d+a))}),g.find("dd[name='pay_bank_list'] li").hover(function(){$(this).find(".bank-name").show()},function(){$(this).find(".bank-name").hide()}),g.find("dd[name='pay_bank_list'] input:radio").click(function(){var c,f,a=$(this).parent().parent().parent().parent().parent(),b=a.find("input[name='payment']");b.attr("checked",!0),a.find("li>label").removeClass("current"),$(this).parent().addClass("current"),c=parseFloat(b.attr("pay_fee")),f=e-d+c,h.html(OW.parsePrice(c)),i.html(OW.parsePrice(f))}),j.click(function(){OW.setDisabled(j,!0);var a,c,d,e;return $input=g.find("input[name='payment']:checked"),$dl=$input.parent().parent(),$dialog=OWDialog().posting().position(),OW.objExist($input)?(c=OW.int($input.val()),d=OW.parseBankCode($input.attr("pay_code")),"alipay"==d&&OW.objExist($dl.find("dd[name='pay_bank_list']"))&&(e=OW.parseBankCode($dl.find("input[name='alipay_bank']:checked").val()),OW.isNull(e))?($dialog.error("请选择银行！").position().timeout(2),OW.setDisabled(j,!1),!1):(a="order_id="+b+"&pay_id="+c+"&bank_code="+e,OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=order&act=payment",data:a,success:function(){var a=OW.ajaxData.is_need_pay_online;a?("weixin"==d&&OW.delay(1e3,function(){OWDialog({id:OW.createDialogID(),close:!1,content:"是否已支付完毕？",ok:function(){OW.refresh()},okValue:"支付完毕",cancel:function(){OW.refresh()},cancelValue:"重新支付"}).fontSize("18px").position()}),OW.redirect(OW.siteUrl+"ow-includes/ow.order_pay.asp?order_id="+b)):OW.redirect(OW.siteUrl+"?ctl=order&act=finish&order_id="+b),$dialog.close()},failed:function(a){$dialog.error("亲，很抱歉，支付方式提交失败，请查看以下信息！",a).position().timeout(3),OW.setDisabled(j,!1)}}),void 0)):($dialog.error("请选择支付方式！").position().timeout(2),OW.setDisabled(j,!1),!1)})},this.buyRecordInit=function(b){a.recordTpl=b.tpl,a.recordCountSection=b.countSection,a.recordListSection=b.listSection,a.recordPagerSection=b.pagerSection,a.recordPageSize=b.pageSize?b.pageSize:20,a.recordPageTpl=b.pageTpl?b.pageTpl:"",b.initGet===!1?!1:!0,OW.isStaticHtml()&&OW.shop.getBuyRecord(1)},this.commentInit=function(b){a.cmtTpl=b.tpl,a.cmtCountSection=b.countSection,a.cmtListSection=b.listSection,a.cmtPagerSection=b.pagerSection,a.cmtPageSize=b.pageSize?b.pageSize:20,a.cmtPageTpl=b.pageTpl?b.pageTpl:"",b.initGet===!1?!1:!0,OW.isStaticHtml()&&OW.shop.getComment(1)},this.consultationInit=function(b){a.cstTpl=b.tpl,a.cstCountSection=b.countSection,a.cstListSection=b.listSection,a.cstPagerSection=b.pagerSection,a.cstPageSize=b.pageSize?b.pageSize:20,a.cstPageTpl=b.pageTpl?b.pageTpl:"",b.initGet===!1?!1:!0,$form=b.form,$vc=b.verifycode,$vv=b.vcodeValue,$submit=b.submit,$author=$form.find("input[name='consult_author']").val(OW.nickname),$authorT=$form.find("span[name='t_consult_author']"),$content=$form.find("textarea[name='consult_content']"),$contentT=$form.find("span[name='t_consult_content']"),$email=$form.find("input[name='consult_email']"),$emailT=$form.find("span[name='t_consult_email']"),$isEmail=$form.find("input[name='is_answer_to_email']"),OW.logined&&($author.val(OW.cookie.getCookie("username")),$author.parent().parent().hide()),$content.blur(function(){$(this).val(OW.left(OW.trim($(this).val()),250))}),$isEmail.click(function(){1==$(this).attr("checked")?$email.parent().parent("dl").show(200):$email.parent().parent("dl").hide(200)}),OW.verifyCode({boxer:$vc}),OW.verifyCodeValueBlur($vv),OW.verifyCodeValueFocus($vv,$vc),OW.enterClick(function(){$submit.click()}),OW.isStaticHtml()&&OW.shop.getConsultation(1),$submit.click(function(){var h,i,a=!0,b=OW.trim($author.val()),c=OW.trim($content.val()),d=OW.int($form.find("input[name='consult_type']:checked").val()),e=OW.trim($email.val()),f=OW.trim($vc.find("input[name='verifycode_name']").val()),g=OW.trim($vv.val());OW.isNull(c)?(a=!1,$content.addClass("textarea-err").focus(),$contentT.addClass("t-err").html("请填写咨询内容")):($content.removeClass("textarea-err"),$contentT.removeClass("t-err").html("")),a&&(OW.isNull(b)?(a=!1,$author.addClass("text-err").focus(),$authorT.addClass("t-err").html("请填写您的称呼")):($author.removeClass("text-err"),$authorT.removeClass("t-err").html(""))),a&&1==$isEmail.attr("checked")&&(OW.isNull(e)?(a=!1,$email.addClass("text-err").focus(),$emailT.addClass("t-err").html("请填写我的邮箱")):OW.isEmail(e)?($email.removeClass("text-err"),$emailT.removeClass("t-err").html("")):(a=!1,$email.addClass("text-err").focus(),$emailT.addClass("t-err").html("邮箱格式不正确，请填写正确的邮箱！"))),a&&(OW.isNull(g)?(a=!1,$vv.addClass("text-err").focus()):$vv.removeClass("text-err")),$email.val(e),$content.val(c),$email.val(e),a&&(h=OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=consult_post",i="cst_type="+d+"&cst_author="+escape(b)+"&cst_content="+escape(c)+"&cst_author_email="+escape(e)+"&gid="+OW.gid+"&verifycode_name="+f+"&verifycode_value="+g,$dialog=OWDialog().posting().follow($content),OW.ajax({url:h,data:i,success:function(){$dialog.success("亲，恭喜，咨询提交成功，请等待客服回复！").timeout(2).removeClose(!0),OW.delay(2200,function(){$content.val("").focus(),$vc.html(""),$vv.val("")})},failed:function(a){$dialog.error("亲，很抱歉，咨询提交失败，请刷新页面再试试！",a).timeout(3),$vv.val("").focus(),OW.verifyCode({boxer:$vc})}}))}),$("img[name='avatar'][src='']").attr("src",OW.siteUrl+"ow-content/images/avatar.jpg")},this.copyright=function(){var a=">o>p>e>n>w>b>s>";return OW.rep(a,">","")},this.priceDisplay=function(){if(OW.logined&&(a.goodsMyPrice<a.goodsPrice?(a.myPriceSection.show(),$("#goods_price").addClass("my-price-show")):(a.myPriceSection.hide(),$("#goods_price").removeClass("my-price-show"))),1==a.pointSet)a.goodsMyPrice<=0?(a.pointplus.hide(),OW.logined&&a.myPriceSection.hide(),a.priceDefGrid.hide()):(a.pointplus.css("display","inline-block"),a.priceDefGrid.show());else{var b=$("#goods_point"),c=b.attr("point_get_type"),d=b.attr("shopping_point_rate"),e=b.attr("point_get_amount");e=OW.iif(0==c,OW.int(a.goodsMyPrice*d),e),b.find("b[name='point']").html(e)}},this.getGoodsInitData=function(){OW.ajax({async:!1,data:"gid="+escape(OW.gid)+"&pid="+escape(a.pid),url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=get_goods_init_data",success:function(){if(OW.shop.productsData=OW.ajaxData.products_data,OW.logined){var b=OW.ajaxData.my_price;a.goodsMyPrice=OW.parseMoney(b),a.myPriceSection.show(),a.myPriceSection.find("[name='my_price']").html(OW.parsePrice(b)),OW.shop.priceDisplay()}$("#suits").html(unescape(OW.ajaxData.suits_html))},failed:function(a){OWDialog().error("亲，很抱歉，获取商品信息失败，请刷新页面再试试！",a).timeout(2)}})},this.goodsSuitInit=function(){var b=$("#goods_suit"),c=b.find("div[name='suit_header']"),d=b.find("button[name='btn_suit_buy']");OW.shop.goodsSuitAmountCount(),b.find("div[name='suit']").each(function(){var a=$(this).attr("suit_id");$(this).find("button[name='btn_suit_buy']").attr("suit_id",a)}),c.click(function(){$section=$(this).parent().find("[name='suit_section']"),"none"==$section.css("display")?$section.show():$section.hide()}),d.click(function(){var b=OW.int($(this).attr("is_book"));return suitId=$(this).attr("suit_id"),a.productAmount=OW.int(a.amountInput.val()),OW.logined||1==OW.int(OW.cookie.getCookie("unlogin_buy"))?(!a.pid>0||a.pid==OW.pid&&a.specCount>0?(a.specSection.parent().addClass("spec-un-selected").focus(),OWDialog().alert("请先选择商品规格").timeout(2)):1==b?a.cartOrderSubmit({is_book:"1",data:'[{"suit_id":"'+suitId+'","gid":"'+OW.gid+'","pid":"'+a.pid+'","m":"'+a.productAmount+'"}]'}):a.addToCart(suitId,OW.gid,a.pid,a.productAmount,function(){OW.redirect(OW.cartUrl,0)}),void 0):(OW.member.loginWindow({success:function(){OW.refresh()}}),!1)})},this.goodsSuitAmountCount=function(){$("#goods_suit").find("[name='suit']").each(function(){var a=$(this),c=(a.find("div[name='suit_header']"),a.find("div[name='suit_section']")),d=a.find("[name='suit_o_amount']");$suitAmount=a.find("[name='suit_amount']"),$suitSave=a.find("[name='suit_save']"),$ul=c.find("ul"),suitOAmount=OW.shop.goodsMyPrice+OW.parseMoney($ul.attr("price_o_amount")),suitAmount=OW.shop.goodsMyPrice+OW.parseMoney($ul.attr("price_amount")),suitSave=OW.parseMoney($ul.attr("price_save")),d.html(OW.parsePrice(suitOAmount)),$suitAmount.html(OW.parsePrice(suitAmount)),$suitSave.html(OW.parsePrice(suitSave))})},this.goodsInit=function(b){var h,i,j,k,l,m,n,o,d=b.btnBook,e=b.btnBuy,f=b.btnBuyCart,g=b.btnCart;a.pid=OW.pid,a.priceSection=b.priceSection,a.marketPriceSection=b.marketPriceSection,a.myPriceSection=b.myPriceSection,a.bookPriceSection=b.bookPriceSection,a.bookMoneySection=$("[name='book_front_money']"),a.bookTimeSection=b.bookTimeSection,a.specSection=b.specSection,a.amountInput=b.amountInput,a.amountDecrease=b.amountDecrease,a.amountIncrease=b.amountIncrease,a.stockTipSection=b.stockTipSection,a.goodsPrice=OW.parseMoney(a.priceSection.html()),a.goodsMyPrice=a.goodsPrice,a.priceDefGrid=a.priceSection.parent().parent().parent(),a.isBook=OW.int(a.bookPriceSection.attr("is_book")),a.pointplus=$("#pointplus"),OW.shop.goodsSpecImagesChangeFun=b.specImagesFun||function(){},OW.shop.goodsSpecDisplay(),OW.shop.getGoodsInitData(),OW.shop.goodsSuitInit(),OW.shop.priceDisplay(),a.productStock=a.productsData[0].stock,$("[name='stock_amount']").html(a.productStock),a.productStock<=0&&(d.attr("disabled",!0).addClass("disabled").html(OW.stocklang),e.attr("disabled",!0).addClass("disabled").html(OW.stocklang),OW.objExist(e)?(g.hide(),f.hide()):(g.attr("disabled",!0).addClass("disabled").html(OW.stocklang),f.attr("disabled",!0).addClass("disabled").html(OW.stocklang)),$("#goods_suit").find("button[name='btn_suit_buy']").attr("disabled",!0).addClass("disabled").html(OW.stocklang)),1==a.isBook&&(h=1,i=1,j=0,k=0,l=OW.int(a.bookTimeSection.attr("book_final_pay_day")),m=OW.int(a.bookTimeSection.attr("is_book_timelimit")),n=a.bookTimeSection.attr("book_starttime"),o=a.bookTimeSection.attr("book_endtime"),a.bookFrontMoneyRate=a.bookPriceSection.attr("book_front_money_rate"),a.bookPriceDiscount=OW.parseMoney(a.bookPriceSection.attr("book_price_discount")),k=a.bookFrontMoneyRate,j=a.goodsMyPrice-a.bookPriceDiscount,0>j&&(j=0),j=j*k/100,1==m&&(OW.isValidDataime(n)&&(h=OW.dateDiff("s",n,OW.now()),0>h&&(d.addClass("disabled").attr("disabled","disabled").html("预订时间未到"),$("#goods_suit").find("button[name='btn_suit_buy']").addClass("disabled").attr("disabled","disabled").html("预订时间未到"))),OW.isValidDataime(o)&&(i=OW.dateDiff("s",OW.now(),o),0>i&&(d.addClass("disabled").attr("disabled","disabled").html("已结束预订"),$("#goods_suit").find("button[name='btn_suit_buy']").addClass("disabled").attr("disabled","disabled").html("已结束预订")))),OW.appendToString="",OW.append("<ul>"),OW.append("<li "+OW.iif(h>0,'class="current"',"")+'><span class="i">1</span><dl><dt>开始预订'+OW.iif(k>0,'<span class="money-rate">(预付款'+k+"%)</span>","")+"</dt><dd>"+OW.iif(1==m&&OW.isValidDataime(n),n,"")+'</dd></dl><div class="tips"></div></li>'),1==m&&OW.isValidDataime(o)&&OW.append("<li "+OW.iif(0>i,'class="current"',"")+'><span class="i"></span><dl><dt>结束预订</dt><dd>'+o+'</dd></dl><div class="tips"></div></li>'),OW.append('<li class="last"><span class="i">2</span><dl><dt>支付尾款/发货</dt><dd></dd></dl><div class="tips">'+OW.iif(l>0,"预计下单"+l+"天后可发货","")+"</div></li>"),OW.append("</ul>"),a.bookTimeSection.append(OW.appendToString).show(),a.bookMoneySection.html(OW.parsePrice(j)),(j>0||a.bookPriceDiscount>0)&&a.bookPriceSection.show()),a.amountInput.blur(function(){var b=$(this).val();b=OW.int(b.replace(/[^0-9]*/g,"")),b>a.productStock&&a.productStock>0&&(b=a.productStock),1>b&&(b=1),$(this).val(b)}),a.amountDecrease.click(function(){var b=OW.int(a.amountInput.val())-1;1>b&&(b=1),a.amountInput.val(b)}),a.amountIncrease.click(function(){var b=OW.int(a.amountInput.val())+1;b>a.productStock&&a.productStock>0&&(b=a.productStock),a.amountInput.val(b)}),d.click(function(){if(!OW.int(a.amountInput.val())>0)return a.stockTipSection.html("亲，购买数量不能小于或为0！").show(100),!1;if(a.stockTipSection.html("").hide(100),!OW.logined&&1!=OW.int(OW.cookie.getCookie("unlogin_buy")))return OW.member.loginWindow({success:function(){OW.refresh()}}),!1;if(!a.pid>0||a.pid==OW.pid&&a.specCount>0)a.specSection.parent().addClass("spec-un-selected");else{if(OW.int(a.amountInput.val())>a.productStock)return a.stockTipSection.html("亲，您所填写的购买数量超过库存了！").show(100),!1;a.stockTipSection.html("").hide(100),a.specSection.parent().removeClass("spec-un-selected"),a.productAmount=OW.int(a.amountInput.val()),a.cartOrderSubmit({is_book:"1",data:'[{"suit_id":"0","gid":"'+OW.gid+'","pid":"'+a.pid+'","m":"'+a.productAmount+'"}]'})}}),e.click(function(){if(!OW.int(a.amountInput.val())>0)return a.stockTipSection.html("亲，购买数量不能小于或为0！").show(100),!1;if(a.stockTipSection.html("").hide(100),!OW.logined&&1!=OW.int(OW.cookie.getCookie("unlogin_buy")))return OW.member.loginWindow({success:function(){OW.refresh()}}),!1;if(!a.pid>0||a.pid==OW.pid&&a.specCount>0)a.specSection.parent().addClass("spec-un-selected").focus(),OWDialog().alert("请先选择商品规格").timeout(2);else{if(OW.int(a.amountInput.val())>a.productStock)return a.stockTipSection.html("亲，您所填写的购买数量超过库存了！").show(100),!1;a.stockTipSection.html("").hide(100),a.specSection.parent().removeClass("spec-un-selected"),a.productAmount=OW.int(a.amountInput.val()),a.cartOrderSubmit({data:'[{"suit_id":"0","gid":"'+OW.gid+'","pid":"'+a.pid+'","m":"'+a.productAmount+'"}]'})}}),f.click(function(){if(!OW.int(a.amountInput.val())>0)return a.stockTipSection.html("亲，购买数量不能小于或为0！").show(100),!1;if(a.stockTipSection.html("").hide(100),!OW.logined&&1!=OW.int(OW.cookie.getCookie("unlogin_buy")))return OW.member.loginWindow({success:function(){OW.refresh()}}),!1;if(!a.pid>0||a.pid==OW.pid&&a.specCount>0)a.specSection.parent().addClass("spec-un-selected").focus(),OWDialog().alert("请先选择商品规格").timeout(2);else{if(OW.int(a.amountInput.val())>a.productStock)return a.stockTipSection.html("亲，您所填写的购买数量超过库存了！").show(100),!1;a.stockTipSection.html("").hide(100),a.specSection.parent().removeClass("spec-un-selected"),a.productAmount=OW.int(a.amountInput.val()),a.addToCart(0,OW.gid,a.pid,a.productAmount,function(){OW.redirect(OW.cartUrl,0)})}}),g.click(function(){if(!OW.int(a.amountInput.val())>0)return a.stockTipSection.html("亲，购买数量不能小于或为0！").show(100),!1;if(a.stockTipSection.html("").hide(100),!OW.logined&&1!=OW.int(OW.cookie.getCookie("unlogin_buy")))return OW.member.loginWindow({success:function(){OW.refresh()}}),!1;if(!a.pid>0||a.pid==OW.pid&&a.specCount>0)a.specSection.parent().addClass("spec-un-selected").focus(),OWDialog().alert("请先选择商品规格").timeout(2);else{if(OW.int(a.amountInput.val())>a.productStock)return a.stockTipSection.html("亲，您所填写的购买数量超过库存了！").show(100),!1;a.stockTipSection.html("").hide(100),a.specSection.parent().removeClass("spec-un-selected"),a.productAmount=OW.int(a.amountInput.val()),a.addToCart(0,OW.gid,a.pid,a.productAmount,function(){a.cartInit({})})}})},this.removeCartGoods=function(a,b,c){var d,e,f,g=OW.cookie.getCookie("cart"),h=new OWDialog({id:OW.createDialogID(),content:"确定要删除吗？",ok:function(){if(!OW.isNull(g))for(e=OW.JSON.parse(g),d=0;d<e.length;d++)if(e[d].suit_id==a&&e[d].gid==b&&e[d].pid==c){e=OW.JSON.del(d,e),f=OW.JSON.toString(e),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=cart&act=save_cart_data",data:"cart_data="+f,async:!1,success:function(){OW.cookie.setCookie("cart",f,10368e5)}});break}return h.success("商品已从购物车删除！").button({id:"ok",remove:!0},{id:"cancel",remove:!0}),window.location.reload(),!1},cancel:!0,close:!1}).position()},this.gartGoodsAmountChange=function(a,b,c){var d,e,f,g=OW.cookie.getCookie("cart");if(!OW.isNull(g))for(e=OW.JSON.parse(g),d=0;d<e.length;d++)if(e[d].gid==a&&e[d].pid==b){e[d].m=OW.toString(OW.int(c)),f=OW.JSON.toString(e),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=cart&act=save_cart_data",data:"cart_data="+f,async:!1,success:function(){OW.cookie.setCookie("cart",f,10368e5)}});break}},this.goodsSpecImagesChangeFun,this.goodsSpecDisplay=function(){var b,c,d,e,f,g,h,i,j,k,l,m=a.specSection,n=OW.trim(m.attr("data")),o='<dl spec_id="{$spec_id}"><dt>{$spec_name}</dt><dd>{$spec_value}</dd></dl>',p="";if(""==n)a.specSection.parent().hide();else{for(n=OW.JSON.parse(n),a.specCount=n.length,e=0;e<n.length;e++){for(g=n[e].spec_id,h=unescape(n[e].spec_name),d=o.replace("{$spec_name}",h).replace("{$spec_id}",g),b=n[e].spec_value,c="",f=0;f<b.length;f++)i=b[f].value_id,j=unescape(b[f].value_name),k=unescape(b[f].value_image),l=b[f].value_images,c=""!=k?c+'<li spec_id="'+g+'" value_id="'+i+'"><a href="javascript:;" spec_id="'+g+'" value_id="'+i+'" value_image="'+k+'" value_images="'+l+'" class="value-img" title="'+j+'"><img src="'+k+'" /><span>'+j+"</span></a></li>":c+'<li spec_id="'+g+'" value_id="'+i+'"><a href="javascript:;" spec_id="'+g+'" value_id="'+i+'" value_image="'+k+'" value_images="'+l+'" title="'+j+'"><span>'+j+"</span></a></li>";""!=c&&(c='<ul spec_id="'+g+'">'+c+"</ul>"),d=d.replace("{$spec_value}",c),p+=d}m.html(p),m.find("a").click(function(){var b,e,f,i,j,k,l,n,o,p;if(a.pid=0,"true"==$(this).parent().attr("disabled"))return!1;if(e=!1,f=$(this).attr("spec_id"),$(this).attr("value_id"),$(this).attr("value_image"),i=$(this).attr("value_images"),j=!0,k=$("div[name='selected_spec_display']"),l=k.find("[name='selected_spec_value']"),n=OW.shop.productsData,$(this).parent().parent().find("li").removeClass("current").attr("selected",!1),$(this).parent().addClass("current").attr("selected",!0),m.find("dl[spec_id!='"+f+"']").find("li").removeClass("disabled").attr("disabled",!1),o=a.getSelectValueId(),o.split(",").length==a.specCount){for(a.productStock=0,b=0;b<n.length;b++)if(o==n[b].spec_value_id){e=!0,a.pid=n[b].pid,a.productSn=n[b].product_sn,a.productStock=n[b].stock,a.priceSection.html(OW.parsePrice(n[b].price)),a.myPriceSection.find("[name='my_price']").html(OW.parsePrice(n[b].my_price)),a.marketPriceSection.html(OW.parsePrice(n[b].market_price)),1==a.isBook&&(p=n[b].my_price-a.bookPriceDiscount,0>p&&(p=0),a.bookMoneySection.html(OW.parsePrice(p*a.bookFrontMoneyRate/100))),a.goodsPrice=OW.parseMoney(n[b].price),a.goodsMyPrice=OW.parseMoney(n[b].my_price),a.MGPricesHtml="",a.specSection.parent().removeClass("spec-un-selected"),OW.shop.priceDisplay(),$("#goods_product_sn").html(a.productSn);break}a.productStock>0?$("[name='stock_amount']").html(a.productStock):(j=!1,$("[name='stock_amount']").html(a.productStock),$(this).parent().removeClass("current").attr("selected",!1).addClass("disabled").attr("disabled",!0))}e?(OW.shop.goodsSuitAmountCount(),$("#goods_suit").find("[name='suit_goods_spec']").html(unescape(n[b].spec_value)),l.html(unescape(n[b].spec_value)),k.show(200)):(l.html(""),k.hide(200)),j&&(OW.isNull(i)||(i=unescape(i),OW.shop.goodsSpecImagesChangeFun(i)))})}},this.getSelectValueId=function(){var b="",c=a.specSection.find("li[selected='true']");return c.each(function(){b=OW.isNull(b)?$(this).attr("value_id"):b+","+$(this).attr("value_id")}),b},this.getMGPrices=function(){var d,b=OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=get_mg_prices";$("div[name='member_group_prices']"),OW.isNull(OW.shop.MGPricesHtml)?(d=OWDialog({close:!0}).loading("正在获取价格...").position().shadow(!1),OW.ajax({url:b,data:"gid="+escape(OW.gid)+"&pid="+escape(a.pid),success:function(){var a,f,g,b='<tr><td class="group-name">{$group}</td><td class="price">'+OW.moneySb+"{$price}</td></tr>",c="",e="",h="";for(f=OW.ajaxData.mgp,g=OW.ajaxData.msgp,(void 0==g||"undefined"==g)&&(g=[]),h='<table border="0" cellpadding="0" cellspacing="0" class="table-price" style="width:100%;"><thead><tr><th>会员</th><th>价格</th></tr></thead>',a=0;a<f.length;a++)c+=b.replace("{$group}",unescape(f[a].group_name)).replace("{$price}",OW.parsePrice(f[a].price));for(a=0;a<g.length;a++)e+=b.replace("{$group}",unescape(g[a].group_name)).replace("{$price}",OW.parsePrice(g[a].price));""!=c&&(c='<tbody class="mg">'+c+"</tbody>"),""!=e&&(e='<tbody class="msg">'+e+"</tbody>"),h=h+c+e+"</table>",d.padding("0px").content(h).position(),OW.shop.MGPricesHtml=h},failed:function(a){d.error("获取会员组价格数据失败！",a).position().timeout(2)}})):d=OWDialog().content(OW.shop.MGPricesHtml).padding("0px").position().shadow(!1)},this.recordTpl="",this.recordCountSection="",this.recordListSection="",this.recordPagerSection="",this.recordPageSize=20,this.recordPageTpl="",this.getBuyRecord=function(b){var f,c=a.recordCountSection,d=a.recordListSection,e=a.recordPagerSection;b=OW.int(b),f=OWDialog({id:OW.createDialogID(),close:!1,shadow:!1}).loading().position(),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=get_buy_record",data:"gid="+escape(OW.gid)+"&page="+b+"&tpl="+escape(a.recordTpl)+"&pagesize="+a.recordPageSize+"&pagetpl="+escape(a.recordPageTpl),success:function(){f.close();var a=OW.int(OW.ajaxData.count),b=OW.ajaxData.list,g=OW.ajaxData.pager;c.html(a),d.hide().html(unescape(b)).show(200),e.html(unescape(g))},failed:function(a){f.close(),d.html("亲，很抱歉，成交记录数据加载失败，请刷新页面再试试！<br>"+a)}})},this.cmtTpl="",this.cmtCountSection="",this.cmtListSection="",this.cmtPagerSection="",this.cmtPageSize=20,this.cmtPageTpl="",this.getComment=function(b){var f,c=a.cmtCountSection,d=a.cmtListSection,e=a.cmtPagerSection;b=OW.int(b),f=OWDialog({id:OW.createDialogID(),close:!1,shadow:!1}).loading(),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=get_comment",data:"gid="+escape(OW.gid)+"&page="+b+"&tpl="+escape(a.cmtTpl)+"&pagesize="+a.cmtPageSize+"&pagetpl="+escape(a.cmtPageTpl),success:function(){f.close();var a=OW.int(OW.ajaxData.count),b=OW.ajaxData.list,g=OW.ajaxData.pager;c.html(a),d.hide().html(unescape(b)).show(200),e.html(unescape(g)),$("img[name='avatar'][src='']").attr("src",OW.siteUrl+"ow-content/images/avatar.jpg"),$("[name='comment_data_reply']").each(function(){OW.isNull($(this).find("[name='reply_content']").html())&&$(this).remove()}),$("[name='cmt_type']").each(function(){$(this).html(commentType($(this).attr("cmt_type")))})},failed:function(a){f.close(),d.html("亲，很抱歉，评论数据加载失败，请刷新页面再试试！<br>"+a)}})},this.cstTpl="",this.cstCountSection="",this.cstListSection="",this.cstPagerSection="",this.cstPageSize=20,this.cstPageTpl="",this.getConsultation=function(b){var f,c=a.cstCountSection,d=a.cstListSection,e=a.cstPagerSection;b=OW.int(b),f=OWDialog({id:OW.createDialogID(),close:!1,shadow:!1}).loading(),OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=goods&act=get_consultation",data:"gid="+escape(OW.gid)+"&page="+b+"&tpl="+escape(a.cstTpl)+"&pagesize="+a.cstPageSize+"&pagetpl="+escape(a.cstPageTpl),success:function(){f.close();var a=OW.int(OW.ajaxData.count),b=OW.ajaxData.list,g=OW.ajaxData.pager;c.html(a),d.hide(50).html(unescape(b)).show(200),e.html(unescape(g)),$("img[name='avatar'][src='']").attr("src",OW.siteUrl+"ow-content/images/avatar.jpg"),$("[name='consult_data_reply']").each(function(){OW.isNull($(this).find("[name='reply_content']").html())&&$(this).remove()
})},failed:function(a){f.close(),d.html("亲，很抱歉，咨询数据加载失败，请刷新页面再试试！<br>"+a)}})}}function couponClass(){this.get=function(a){var b=OWDialog({close:!1}).loading("正在获取优惠券...").position();OW.ajax({url:OW.sitePath+"ow-includes/ow.ajax.shop.asp?ctl=coupon&act=get_coupon",data:"coupon_id="+escape(a),success:function(){b.success("成功获取优惠券").position()},failed:function(a){b.error("获取优惠券失败",a).position()}})}}function mobile(){this.menu=function(){var b=$("#top_menu"),c=$("#top_menu_section"),d=$("#top_menu_close");b.click(function(){c.slideDown(100)}),d.click(function(){c.slideUp(100)})},this.nav=function(a){var d,e,b=a.omNav,c=a.baseNav;0==OW.int(b.find("li[n1='true']").length)?(b.hide(),$("body").addClass("body-none-nav")):(b.show(),d=100,e=OW.int(c.find("li[n1='true']").length),c.find("a.n1").click(function(){var a=$(this).parent();return i=a.attr("i"),$sub=a.find("div[name='subnav']"),OW.objExist($sub)?("none"==$sub.css("display")?(b.find("div[name='subnav']").hide(),i==e&&$sub.css("right","10px"),$sub.show()):$sub.hide(),!1):void 0}),e>0&&(liWidth=d/e,c.find("li[n1='true']").css({width:liWidth+"%"})))}}OW.mobile=new mobile,OW.client=new client,OW.ad=new ADClass,OW.cmt=new CMTClass,OW.link=new linkClass,OW.gallery=new galleryClass,OW.member=new memberClass,OW.search=new searchClass,OW.shop=new shopClass,OW.coupon=new couponClass;